extends layout

block styles
  link(rel='stylesheet', href='/stylesheets/my_stuff.css')

mixin device_list(devices, online, datasource)
  div.row
    each dev, i in devices
      if i % 6 === 0
        div.clearfix.visible-lg.visible-md
      else if i % 3 === 0
        div.clearfix.visible-lg
      else if i % 2 === 0
        div.clearfix.visible-md
      div.col-lg-4.col-md-6
        div.panel.panel-default.installed-dev
          if dev.kind
            a(href='https://thingengine.stanford.edu/thingpedia/devices/by-id/' + dev.kind).panel-heading
              h2.panel-title= dev.name
          else
            div.panel-heading
              h2.panel-title= dev.name
          div.panel-body
            p= dev.description

            if !online
              if dev.ownerTier !== 'cloud'
                p This device is owned by your #{dev.ownerTier}.

              if dev.available == 0
                p The device is not available. It might be powered off or disconnected.
              else if dev.available == 1
                p The device is available and working.
              else if dev.available == 2
                if dev.ownerTier === 'server'
                  p The device is not available because your server is disconnected.
                    |  Make sure that it is powered on and correctly configured.
                else if dev.ownerTier === 'phone'
                  p The device is not available because your phone is disconnected.
                    |  Make sure that it is powered on and connected to the network.
                else
                  p The device is not available because ThingEngine Online cannot be reached.
                    |  There might be a temporary service outage.
              else
                p It was not possible to verify if the device is available.
                  | Please check it is powered on and correctly configured.
          div.panel-footer
            div.row
              if !dev.isTransient
                div.col-md-6
                  if datasource
                    a(href='/devices/delete/' + dev.uniqueId).btn.btn-danger.btn-sm.btn-block Disable
                  else
                    a(href='/devices/delete/' + dev.uniqueId).btn.btn-danger.btn-sm.btn-block Forget

block content
  h2 Enabled Data Sources

  +device_list(datasourceDevices, true, true)

  div.row
    div.col-sm-6.col-md-3
      a(href='/devices/create?class=data').btn.btn-primary.btn-block Enable new data source

  h2 My Devices

  +device_list(physicalDevices, false, false)

  div.row
    div.col-sm-6.col-md-3
      a(href='/devices/create?class=physical').btn.btn-primary.btn-block Configure new device

  h2 My Accounts

  +device_list(onlineDevices, true, false)

  div.row
    div.col-sm-6.col-md-3
      a(href='/devices/create?class=online').btn.btn-primary.btn-block Add new account

